<!DOCTYPE html>
<html class="no-js" itemscope="" itemtype="http://schema.org/WebPage" lang="en"><head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name="viewport"/><meta content="Hugo 0.108.0" name="generator"/><meta content="index, follow" name="robots"/><link href="../../../favicons/favicon.ico" rel="shortcut icon"/><link href="../../../favicons/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180"/><link href="../../../favicons/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"/><link href="../../../favicons/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"/><link href="../../../favicons/android-36x36.png" rel="icon" sizes="36x36" type="image/png"/><link href="../../../favicons/android-48x48.png" rel="icon" sizes="48x48" type="image/png"/><link href="../../../favicons/android-72x72.png" rel="icon" sizes="72x72" type="image/png"/><link href="../../../favicons/android-96x96.png" rel="icon" sizes="96x96" type="image/png"/><link href="../../../favicons/android-144x144.png" rel="icon" sizes="144x144" type="image/png"/><link href="../../../favicons/android-192x192.png" rel="icon" sizes="192x192" type="image/png"/><title>Interfaces | DPsim</title><meta content="Interfaces can be used to exchange simulation signals between a DPsim simulation and other soft- or hardware, for example an MQTT-broker or an FPGA. Simulation signals in the form of Attributes can be imported or exported once per simulation time step. Interfaces are subclasses of Interface and implement the methods addExport and addImport, which add dependencies to the passed attribute that forward the attribute value from or to the interface. This way, attributes that are imported are read from the interface before they are used in any DPsim component." name="description"/><meta content="Interfaces" property="og:title"/><meta content="Interfaces can be used to exchange simulation signals between a DPsim simulation and other soft- or hardware, for example an MQTT-broker or an FPGA. Simulation signals in the form of Attributes can be imported or exported once per simulation time step. Interfaces are subclasses of Interface and implement the methods addExport and addImport, which add dependencies to the passed attribute that forward the attribute value from or to the interface. This way, attributes that are imported are read from the interface before they are used in any DPsim component." property="og:description"/><meta content="article" property="og:type"/><meta content="https://dpsim.fein-aachen.org/docs/overview/interfaces/" property="og:url"/><meta content="docs" property="article:section"/><meta content="2025-02-13T00:00:00+00:00" property="article:published_time"/><meta content="2025-10-09T15:27:51+02:00" property="article:modified_time"/><meta content="DPsim" property="og:site_name"/><meta content="Interfaces" itemprop="name"/><meta content="Interfaces can be used to exchange simulation signals between a DPsim simulation and other soft- or hardware, for example an MQTT-broker or an FPGA. Simulation signals in the form of Attributes can be imported or exported once per simulation time step. Interfaces are subclasses of Interface and implement the methods addExport and addImport, which add dependencies to the passed attribute that forward the attribute value from or to the interface. This way, attributes that are imported are read from the interface before they are used in any DPsim component." itemprop="description"/><meta content="2025-02-13T00:00:00+00:00" itemprop="datePublished"/><meta content="2025-10-09T15:27:51+02:00" itemprop="dateModified"/><meta content="1113" itemprop="wordCount"/><meta content="" itemprop="keywords"/><meta content="summary" name="twitter:card"/><meta content="Interfaces" name="twitter:title"/><meta content="Interfaces can be used to exchange simulation signals between a DPsim simulation and other soft- or hardware, for example an MQTT-broker or an FPGA. Simulation signals in the form of Attributes can be imported or exported once per simulation time step. Interfaces are subclasses of Interface and implement the methods addExport and addImport, which add dependencies to the passed attribute that forward the attribute value from or to the interface. This way, attributes that are imported are read from the interface before they are used in any DPsim component." name="twitter:description"/><link as="style" href="../../../scss/main.min.73bc65c1e18bb0cbd02b071f40b73b018bed23b1835e915c0f4f73a772a6713b.css" rel="preload"/><link href="../../../scss/main.min.73bc65c1e18bb0cbd02b071f40b73b018bed23b1835e915c0f4f73a772a6713b.css" integrity="" rel="stylesheet"/><script crossorigin="anonymous" integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script crossorigin="anonymous" defer="" integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli" src="https://unpkg.com/lunr@2.3.9/lunr.min.js"></script></head><body class="td-page"><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class="navbar-brand" href="../../../index.html"><span class="navbar-brand__logo navbar-logo"></span><span class="navbar-brand__name">DPsim</span></a><div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar"><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href="../../index.html"><span class="active">Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><div class="td-search td-search--offline"><div class="td-search__icon"></div><input aria-label="Search this site…" autocomplete="off" class="td-search__input form-control" data-offline-search-base-href="/" data-offline-search-index-json-src="/offline-search-index.6e190e0fa554642d85037c34aa773c60.json" data-offline-search-max-results="10" placeholder="Search this site…" type="search"/></div></div></nav></header><div class="container-fluid td-outer"><div class="td-main"><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div class="td-sidebar__inner" id="td-sidebar-menu"><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class="td-search__icon"></div><input aria-label="Search this site…" autocomplete="off" class="td-search__input form-control" data-offline-search-base-href="/" data-offline-search-index-json-src="/offline-search-index.6e190e0fa554642d85037c34aa773c60.json" data-offline-search-max-results="10" placeholder="Search this site…" type="search"/></div><button aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation" class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" data-target="#td-section-nav" data-toggle="collapse" type="button"></button></form><nav class="collapse td-sidebar-nav" id="td-section-nav"><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docs-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" href="../../index.html" id="m-docs"><span>Documentation</span></a><ul class="ul-1"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docsoverview-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section" href="../index.html" id="m-docsoverview"><span>Overview</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsoverviewarchitecture-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../architecture/index.html" id="m-docsoverviewarchitecture"><span>Architecture</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsoverviewattributes-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../attributes/index.html" id="m-docsoverviewattributes"><span>Attributes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsoverviewscheduling-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../scheduling/index.html" id="m-docsoverviewscheduling"><span>Scheduling</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-docsoverviewinterfaces-li"><a class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" href="index.html" id="m-docsoverviewinterfaces"><span class="td-sidebar-nav-active-item">Interfaces</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsoverviewmnainterface-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../mnainterface/index.html" id="m-docsoverviewmnainterface"><span>Interfacing with the MNA Solver</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsoverviewsubcomponents-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../subcomponents/index.html" id="m-docsoverviewsubcomponents"><span>Subcomponent Handling</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsgetting-started-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section" href="../../getting-started/index.html" id="m-docsgetting-started"><span>Getting Started</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgetting-startedreal-time-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../getting-started/real-time/index.html" id="m-docsgetting-startedreal-time"><span>Real-Time</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgetting-startedbuild-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../getting-started/build/index.html" id="m-docsgetting-startedbuild"><span>Build</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgetting-startedinstall-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../getting-started/install/index.html" id="m-docsgetting-startedinstall"><span>Install</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsconcepts-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section" href="../../concepts/index.html" id="m-docsconcepts"><span>Concepts</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsconceptsdyn-phasors-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../concepts/dyn-phasors/index.html" id="m-docsconceptsdyn-phasors"><span>Dynamic Phasors</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsconceptsnodal-analysis-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../concepts/nodal-analysis/index.html" id="m-docsconceptsnodal-analysis"><span>Nodal Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsconceptspowerflow-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../concepts/powerflow/index.html" id="m-docsconceptspowerflow"><span>Powerflow</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsdevelopment-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section" href="../../development/index.html" id="m-docsdevelopment"><span>Development</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdevelopmentdebugging-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../development/debugging/index.html" id="m-docsdevelopmentdebugging"><span>Debugging</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdevelopmentguidelines-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../development/guidelines/index.html" id="m-docsdevelopmentguidelines"><span>Guidelines</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsmodels-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section" href="../../models/index.html" id="m-docsmodels"><span>Models</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmodelstransformer-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../models/transformer/index.html" id="m-docsmodelstransformer"><span>Transformer</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmodelsbranches-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../models/branches/index.html" id="m-docsmodelsbranches"><span>Branches</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmodelsinduction-machine-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../models/induction-machine/index.html" id="m-docsmodelsinduction-machine"><span>Induction Machine</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmodelsrlc-elements-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../models/rlc-elements/index.html" id="m-docsmodelsrlc-elements"><span>RLC-Elements</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmodelssynchronous-generator-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../models/synchronous-generator/index.html" id="m-docsmodelssynchronous-generator"><span>Synchronous Generator</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmodelspower-electronics-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../models/power-electronics/index.html" id="m-docsmodelspower-electronics"><span>VS-Inverter</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docstasks-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section" href="../../tasks/index.html" id="m-docstasks"><span>Core Tasks</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docstasksadd-model-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../tasks/add-model/index.html" id="m-docstasksadd-model"><span>Add New Model</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docstaskscreate-simulation-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../tasks/create-simulation/index.html" id="m-docstaskscreate-simulation"><span>Create New Simulation</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamples-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section" href="../../examples/index.html" id="m-docsexamples"><span>Examples</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsroadmap-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../roadmap/index.html" id="m-docsroadmap"><span>Roadmap</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsreference-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../reference/index.html" id="m-docsreference"><span>Reference</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docscontribution-guidelines-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../contribution-guidelines/index.html" id="m-docscontribution-guidelines"><span>Contribution Guidelines</span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a class="td-page-meta--view" href="https://github.com/sogno-platform/dpsim/tree/master/content/en/docs/Overview/interfaces.md" rel="noopener" target="_blank"><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a class="td-page-meta--edit" href="https://github.com/sogno-platform/dpsim/edit/master/content/en/docs/Overview/interfaces.md" rel="noopener" target="_blank"><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a class="td-page-meta--child" href="https://github.com/sogno-platform/dpsim/new/master/content/en/docs/Overview/interfaces.md?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" rel="noopener" target="_blank"><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a class="td-page-meta--issue" href="https://github.com/sogno-platform/dpsim/issues/new?title=Interfaces" rel="noopener" target="_blank"><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a class="td-page-meta--project-issue" href="https://github.com/sogno-platform/dpsim/issues/new" rel="noopener" target="_blank"><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a>
<a href="../_print/index.html" id="print"><i class="fa-solid fa-print fa-fw"></i> Print entire section</a></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main"><nav aria-label="breadcrumb" class="td-breadcrumbs"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../index.html">Documentation</a></li><li class="breadcrumb-item"><a href="../index.html">Overview</a></li><li aria-current="page" class="breadcrumb-item active"><a aria-disabled="true" class="btn-link disabled" href="index.html">Interfaces</a></li></ol></nav><div class="td-content"><h1>Interfaces</h1><header class="article-meta"></header><p>Interfaces can be used to exchange simulation signals between a DPsim simulation and other soft- or hardware, for example an MQTT-broker or an FPGA.
Simulation signals in the form of <a href="../attributes/index.html">Attributes</a> can be <strong>imported</strong> or <strong>exported</strong> once per simulation time step.
Interfaces are subclasses of <code>Interface</code> and implement the methods <code>addExport</code> and <code>addImport</code>, which add dependencies to the passed attribute that forward the attribute value from or to the interface.
This way, attributes that are imported are read from the interface before they are used in any DPsim component.
Attributes that are exported are written to the interface after they are set by a DPsim component.</p><h1 id="interfacing-with-villasnode">Interfacing with VILLASnode</h1><blockquote><p>This feature requires the compilation of DPsim with the <code>WITH_VILLAS</code> feature flag. For use of the VILLASnode interface in python, the <code>dpsimpyvillas</code> target has to built in addition to the normal <code>dpsimpy</code> package.</p></blockquote><p>The VILLASnode interface is designed to make use of the various node types and protocols supported by the <a href="https://github.com/VILLASframework/node">VILLASframework</a>.
By utilizing the nodes provided by VILLASnode, it can be configured to import and export attributes using a wide range of protocols.
There are two interface implementations for VILLASnode: <code>InterfaceVillasQueued</code> and <code>InterfaceVillasQueueless</code>.
<code>InterfaceVillasQueued</code> uses a ring buffer to store signal data between DPsim and VILLASnode to allow the protocol used in VILLASnode to operate at a different rate and non-synchronized to the DPsim time step.
<code>InterfaceVillasQueueless</code> uses direct communication with a VILLASnode node type implementing a specific protocol without using a buffer, thus enabling significantly lower latency communication.
With <code>InterfaceVillasQueueless</code>, the protocol operates at the time step of DPsim, i.e., an attribute update directly triggers a <code>write()</code> call to the connected VILLASnode node type.
<code>InterfaceVillasQueued</code> should be used when using non- or soft real-time protocols or communication mediums, such as MQTT or connections via the internet.
<code>InterfaceVillasQueueless</code> should be used when communicating using reliable, low latency, real-time protocols, e.g., with FPGAs, via dedicated fibre networks, or with local real-time applications.</p><p>To create and configure one of the VILLASnode interface instance, create a new shared pointer of type <code>InterfaceVillasQueued</code> or <code>InterfaceVillasQueueless</code> and supply it with a configuration string in the first constructor argument.
This configuration must be a valid JSON object containing the settings for the VILLASnode node type that should be used for data import and export.
This means that the JSON contains a <code>type</code> key describing what node type to use, as well as any additional configuration options required for this node type.
The valid configuration keys can be found in the <a href="https://villas.fein-aachen.org/doc/node-node-types.html">VILLASnode documentation</a>.</p><blockquote><p>Note for <code>InterfaceVillasQueueless</code>:
The queueless interface expects the first input signal in the VILLASnode configuration to be a sequence number that is incremented every time step.
If the value of the sequence number is not incremented by one between two consecutive time steps, an overrun is detected.
Because logging outputs can cause large delays and overruns should not occur spuriously, the interface only reports a warning when a large number of overruns occur.</p></blockquote><p>After the object is created, the <code>exportAttribute</code> and <code>importAttribute</code> methods can be used to set up the data exchange between the DPsim simulation and the configured node.
The attributes given as the first parameter to these methods are attributes belonging to components in the simulation which should be read or updated by the interface.
As an example, for exporting and importing attributes via the MQTT protocol, the VILLASnode interfaces can be configured as follows:</p><p>Using C++:</p><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-cpp" data-lang="cpp"><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">// JSON configuration adhering to the VILLASnode documentation
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">std</span><span style="color:#ce5c00;font-weight:700">::</span><span style="color:#000">string</span> <span style="color:#000">mqttConfig</span> <span style="color:#ce5c00;font-weight:700">=</span> <span style="color:#000">R</span><span style="color:#4e9a06">"STRING({</span>
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">"type"</span><span style="color:#ce5c00;font-weight:700">:</span> <span style="color:#4e9a06">"mqtt"</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">"format"</span><span style="color:#ce5c00;font-weight:700">:</span> <span style="color:#4e9a06">"json"</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">"host"</span><span style="color:#ce5c00;font-weight:700">:</span> <span style="color:#4e9a06">"mqtt"</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">"in"</span><span style="color:#ce5c00;font-weight:700">:</span> <span style="color:#000;font-weight:700">{</span>
</span></span><span style="display:flex"><span>        <span style="color:#4e9a06">"subscribe"</span><span style="color:#ce5c00;font-weight:700">:</span> <span style="color:#4e9a06">"/mqtt-dpsim"</span>
</span></span><span style="display:flex"><span>    <span style="color:#000;font-weight:700">},</span>
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">"out"</span><span style="color:#ce5c00;font-weight:700">:</span> <span style="color:#000;font-weight:700">{</span>
</span></span><span style="display:flex"><span>        <span style="color:#4e9a06">"publish"</span><span style="color:#ce5c00;font-weight:700">:</span> <span style="color:#4e9a06">"/dpsim-mqtt"</span>
</span></span><span style="display:flex"><span>    <span style="color:#000;font-weight:700">}</span>
</span></span><span style="display:flex"><span><span style="color:#000;font-weight:700">})</span><span style="color:#000">STRING</span><span style="color:#4e9a06">";</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">// Creating a new InterfaceVillas object
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">std</span><span style="color:#ce5c00;font-weight:700">::</span><span style="color:#000">shared_ptr</span><span style="color:#ce5c00;font-weight:700">&lt;</span><span style="color:#000">InterfaceVillasQueued</span><span style="color:#ce5c00;font-weight:700">&gt;</span> <span style="color:#000">intf</span> <span style="color:#ce5c00;font-weight:700">=</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:700">::</span><span style="color:#000">make_shared</span><span style="color:#ce5c00;font-weight:700">&lt;</span><span style="color:#000">InterfaceVillasQueued</span><span style="color:#ce5c00;font-weight:700">&gt;</span><span style="color:#000;font-weight:700">(</span><span style="color:#000">mqttConfig</span><span style="color:#000;font-weight:700">);</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">// Configuring the InterfaceVillas to import and export attributes
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">intf</span><span style="color:#ce5c00;font-weight:700">-&gt;</span><span style="color:#000">importAttribute</span><span style="color:#000;font-weight:700">(</span><span style="color:#000">evs</span><span style="color:#ce5c00;font-weight:700">-&gt;</span><span style="color:#000">mVoltageRef</span><span style="color:#000;font-weight:700">,</span> <span style="color:#0000cf;font-weight:700">0</span><span style="color:#000;font-weight:700">,</span> <span style="color:#204a87">true</span><span style="color:#000;font-weight:700">,</span> <span style="color:#204a87">true</span><span style="color:#000;font-weight:700">);</span>
</span></span><span style="display:flex"><span><span style="color:#000">intf</span><span style="color:#ce5c00;font-weight:700">-&gt;</span><span style="color:#000">exportAttribute</span><span style="color:#000;font-weight:700">(</span><span style="color:#000">r12</span><span style="color:#ce5c00;font-weight:700">-&gt;</span><span style="color:#000">mIntfCurrent</span><span style="color:#ce5c00;font-weight:700">-&gt;</span><span style="color:#000">deriveCoeff</span><span style="color:#ce5c00;font-weight:700">&lt;</span><span style="color:#000">Complex</span><span style="color:#ce5c00;font-weight:700">&gt;</span><span style="color:#000;font-weight:700">(</span><span style="color:#0000cf;font-weight:700">0</span><span style="color:#000;font-weight:700">,</span> <span style="color:#0000cf;font-weight:700">0</span><span style="color:#000;font-weight:700">),</span> <span style="color:#0000cf;font-weight:700">1</span><span style="color:#000;font-weight:700">,</span> <span style="color:#204a87">true</span><span style="color:#000;font-weight:700">,</span> <span style="color:#4e9a06">"v_load"</span><span style="color:#000;font-weight:700">);</span>
</span></span></code></pre></div><p>Using Python:</p><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-python" data-lang="python"><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"># JSON configuration adhering to the VILLASnode documentation</span>
</span></span><span style="display:flex"><span><span style="color:#000">mqtt_config</span> <span style="color:#ce5c00;font-weight:700">=</span> <span style="color:#4e9a06">'''{
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        "type": "mqtt",
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        "format": "json",
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        "host": "mqtt",
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        "in": {
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">            "subscribe": "/mqtt-dpsim"
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        },
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        "out": {
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">            "publish": "/dpsim-mqtt"
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        }
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">}'''</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"># Creating a new InterfaceVillas object</span>
</span></span><span style="display:flex"><span><span style="color:#000">intf</span> <span style="color:#ce5c00;font-weight:700">=</span> <span style="color:#000">dpsimpyvillas</span><span style="color:#ce5c00;font-weight:700">.</span><span style="color:#000">InterfaceVillas</span><span style="color:#000;font-weight:700">(</span><span style="color:#000">name</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">'dpsim-mqtt'</span><span style="color:#000;font-weight:700">,</span> <span style="color:#000">config</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#000">mqtt_config</span><span style="color:#000;font-weight:700">)</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"># Configuring the InterfaceVillas to import and export attributes</span>
</span></span><span style="display:flex"><span><span style="color:#000">intf</span><span style="color:#ce5c00;font-weight:700">.</span><span style="color:#000">import_attribute</span><span style="color:#000;font-weight:700">(</span><span style="color:#000">evs</span><span style="color:#ce5c00;font-weight:700">.</span><span style="color:#000">attr</span><span style="color:#000;font-weight:700">(</span><span style="color:#4e9a06">'V_ref'</span><span style="color:#000;font-weight:700">),</span> <span style="color:#0000cf;font-weight:700">0</span><span style="color:#000;font-weight:700">,</span> <span style="color:#204a87;font-weight:700">True</span><span style="color:#000;font-weight:700">)</span>
</span></span><span style="display:flex"><span><span style="color:#000">intf</span><span style="color:#ce5c00;font-weight:700">.</span><span style="color:#000">export_attribute</span><span style="color:#000;font-weight:700">(</span><span style="color:#000">r12</span><span style="color:#ce5c00;font-weight:700">.</span><span style="color:#000">attr</span><span style="color:#000;font-weight:700">(</span><span style="color:#4e9a06">'i_intf'</span><span style="color:#000;font-weight:700">)</span><span style="color:#ce5c00;font-weight:700">.</span><span style="color:#000">derive_coeff</span><span style="color:#000;font-weight:700">(</span><span style="color:#0000cf;font-weight:700">0</span><span style="color:#000;font-weight:700">,</span> <span style="color:#0000cf;font-weight:700">0</span><span style="color:#000;font-weight:700">),</span> <span style="color:#0000cf;font-weight:700">0</span><span style="color:#000;font-weight:700">)</span>
</span></span></code></pre></div><h1 id="adding-an-interface-to-the-simulation">Adding an Interface to the Simulation</h1><p>After a new interface has been created and configured, it can be added to a simulation using the <code>Simulation::addInterface</code> method:</p><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4" tabindex="0"><code class="language-cpp" data-lang="cpp"><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">// Create and configure simulation
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">RealTimeSimulation</span> <span style="color:#000">sim</span><span style="color:#000;font-weight:700">(</span><span style="color:#000">simName</span><span style="color:#000;font-weight:700">);</span>
</span></span><span style="display:flex"><span><span style="color:#000">sim</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">setSystem</span><span style="color:#000;font-weight:700">(</span><span style="color:#000">sys</span><span style="color:#000;font-weight:700">);</span>
</span></span><span style="display:flex"><span><span style="color:#000">sim</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">setTimeStep</span><span style="color:#000;font-weight:700">(</span><span style="color:#000">timeStep</span><span style="color:#000;font-weight:700">);</span>
</span></span><span style="display:flex"><span><span style="color:#000">sim</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">setFinalTime</span><span style="color:#000;font-weight:700">(</span><span style="color:#0000cf;font-weight:700">10.0</span><span style="color:#000;font-weight:700">);</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">// Create and configure interface
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:700">auto</span> <span style="color:#000">intf</span> <span style="color:#ce5c00;font-weight:700">=</span> <span style="color:#8f5902;font-style:italic">//...
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">// Add interface to simulation
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">sim</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">addInterface</span><span style="color:#000;font-weight:700">(</span><span style="color:#000">intf</span><span style="color:#000;font-weight:700">);</span>
</span></span></code></pre></div><p>This method will add two new <a href="../scheduling/index.html">Tasks</a> to the simulation. The interface’s <code>PreStep</code> task is set to modify all attributes that are imported from the environment and is therefore scheduled to execute before any other simulation tasks that depend on these attributes.
The interface’s <code>PostStep</code> task is set to depend on all attributes that are exported to the environment and is therefore scheduled to execute after any other simulation tasks that might modify these attributes. To prevent the scheduler from just dropping the <code>PostStep</code> task since it does not modify any attributes and is therefore not seen as relevant to the simulation, the task is set to modify the <code>Scheduler::external</code> attribute.
Note that the execution of these tasks might not necessarily coincide with the point in time at which the values are actually written out to or read from the environment.
This is because the interface internally spawns two new threads for exchanging data with the environment and then uses a <strong>lock-free queue</strong> for communication between these reader and writer threads, and the simulation. Because of this, time-intensive import or export operations will not block
the main simulation thread unless this is explicitly configured in the interface’s <code>importAttribute</code> and <code>exportAttribute</code> methods.</p><h1 id="synchronizing-the-simulation-with-the-environment">Synchronizing the Simulation with the Environment</h1><p>To allow for synchronizing the DPsim simulation with external services, the <code>Interface</code> class provides some additional configuration options in the <code>importAttribute</code> and <code>exportAttribute</code> methods. For imports, setting the <code>blockOnRead</code> parameter will completely halt the simulation at the start of
every time step until a new value for this attribute was read from the environment. Additionally, the <code>syncOnSimulationStart</code> parameter can be set for every
import to indicate that this attribute is used to synchronize the start of the simulation. When a simulation contains any interfaces importing attributes
which have <code>syncOnSimulationStart</code> set, the <code>Simulation::sync</code> will be called before the first time step. This method will:</p><ul><li>write out all attributes configured for export to the environment</li><li>block until all attributes with <code>syncOnSimulationStart</code> set have been read from the environment at least once</li><li>write out all exported attributes again</li></ul><p>Note that this setting operates independently of the <code>blockOnRead</code> flag. This means that with both flags set, the simulation will block again after the synchronization at the start of the first time step until another value is received for the attribute in question.</p><div class="text-muted mt-5 pt-3 border-top">Last modified 09.10.2025: <a href="https://github.com/sogno-platform/dpsim/commit/452323ca7ab3dc1e75644a56f682e6fe0c3e4ac4">chore(deps): Bump pypa/gh-action-pypi-publish from 1.12.4 to 1.13.0 in /.github/workflows (#405) (452323c)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class="row"><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li aria-label="Slack" class="list-inline-item mx-2 h3" data-placement="top" data-toggle="tooltip" title="Slack"><a aria-label="Slack" class="text-white" href="https://slack.lfenergy.org/" rel="noopener" target="_blank"><i class="fab fa-slack"></i></a></li><li aria-label="GitHub Discussions" class="list-inline-item mx-2 h3" data-placement="top" data-toggle="tooltip" title="GitHub Discussions"><a aria-label="GitHub Discussions" class="text-white" href="https://github.com/sogno-platform/dpsim/discussions" rel="noopener" target="_blank"><i class="fab fa-github"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li aria-label="GitHub" class="list-inline-item mx-2 h3" data-placement="top" data-toggle="tooltip" title="GitHub"><a aria-label="GitHub" class="text-white" href="https://github.com/sogno-platform/dpsim" rel="noopener" target="_blank"><i class="fab fa-github"></i></a></li><li aria-label="RWTH GitLab" class="list-inline-item mx-2 h3" data-placement="top" data-toggle="tooltip" title="RWTH GitLab"><a aria-label="RWTH GitLab" class="text-white" href="https://git.rwth-aachen.de/acs/public/simulation/dpsim/dpsim" rel="noopener" target="_blank"><i class="fab fa-gitlab"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class="text-white">© 2025 The DPsim Authors All Rights Reserved</small></div></div></div></footer></div><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" integrity="sha512-6VMVcy7XQNyarhVuiL50FzpgCFKsyTd6YO93aaQEyET+BNaWvj0IgKR86Bf6+AmWczxAcSnL+JGjo+iStgO1gQ==" rel="stylesheet"/><script crossorigin="anonymous" defer="" integrity="sha512-b9IKj4LCNrtCPBhceRcoYOHWW/S2q9fpl7iAJlyxYpykRj1SKM7FE9+E0NEnJ8g8ni47LBr2GuX9qzg/xeuwzQ==" src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.js"></script><script crossorigin="anonymous" defer="" integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg==" onload='renderMathInElement(document.body,{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"},{display:!0,left:"\\[",right:"\\]"}]})' src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js"></script><script crossorigin="anonymous" integrity="sha256-Kv+YPp0Njs/57VPhS2VyFuLY0q/wWb9KVlEoMCCZXxs=" src="../../../js/main.min.2aff983e9d0d8ecff9ed53e14b657216e2d8d2aff059bf4a5651283020995f1b.js"></script>
<script src="../../../js/tabpane-persist.js"></script></body></html>