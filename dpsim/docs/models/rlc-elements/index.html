<!DOCTYPE html>
<html class="no-js" itemscope="" itemtype="http://schema.org/WebPage" lang="en"><head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name="viewport"/><meta content="Hugo 0.108.0" name="generator"/><meta content="index, follow" name="robots"/><link href="../../../favicons/favicon.ico" rel="shortcut icon"/><link href="../../../favicons/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180"/><link href="../../../favicons/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"/><link href="../../../favicons/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"/><link href="../../../favicons/android-36x36.png" rel="icon" sizes="36x36" type="image/png"/><link href="../../../favicons/android-48x48.png" rel="icon" sizes="48x48" type="image/png"/><link href="../../../favicons/android-72x72.png" rel="icon" sizes="72x72" type="image/png"/><link href="../../../favicons/android-96x96.png" rel="icon" sizes="96x96" type="image/png"/><link href="../../../favicons/android-144x144.png" rel="icon" sizes="144x144" type="image/png"/><link href="../../../favicons/android-192x192.png" rel="icon" sizes="192x192" type="image/png"/><title>RLC-Elements | DPsim</title><meta content="EMT Equations and Modified Nodal Analysis Inductance An inductance is described by
$$v_j(t) - v_k(t) = v_L(t) = L \frac{\mathrm{d} i_L(t)}{\mathrm{d}t}$$Integration results in an equation to compute the current at time $t$ from a previous state at $t - \Delta t$.
$$i_L(t) = i_L(t - \Delta t) + \frac{1}{L} \ \int_{t - \Delta t}^{t} v_L(\tau) \ \mathrm{d} \tau$$There are various methods to discretize this equation in order to solve it numerically." name="description"/><meta content="RLC-Elements" property="og:title"/><meta content="EMT Equations and Modified Nodal Analysis Inductance An inductance is described by
$$v_j(t) - v_k(t) = v_L(t) = L \frac{\mathrm{d} i_L(t)}{\mathrm{d}t}$$Integration results in an equation to compute the current at time $t$ from a previous state at $t - \Delta t$.
$$i_L(t) = i_L(t - \Delta t) + \frac{1}{L} \ \int_{t - \Delta t}^{t} v_L(\tau) \ \mathrm{d} \tau$$There are various methods to discretize this equation in order to solve it numerically." property="og:description"/><meta content="article" property="og:type"/><meta content="https://dpsim.fein-aachen.org/docs/models/rlc-elements/" property="og:url"/><meta content="docs" property="article:section"/><meta content="2020-03-18T00:00:00+00:00" property="article:published_time"/><meta content="2025-10-09T15:27:51+02:00" property="article:modified_time"/><meta content="DPsim" property="og:site_name"/><meta content="RLC-Elements" itemprop="name"/><meta content="EMT Equations and Modified Nodal Analysis Inductance An inductance is described by
$$v_j(t) - v_k(t) = v_L(t) = L \frac{\mathrm{d} i_L(t)}{\mathrm{d}t}$$Integration results in an equation to compute the current at time $t$ from a previous state at $t - \Delta t$.
$$i_L(t) = i_L(t - \Delta t) + \frac{1}{L} \ \int_{t - \Delta t}^{t} v_L(\tau) \ \mathrm{d} \tau$$There are various methods to discretize this equation in order to solve it numerically." itemprop="description"/><meta content="2020-03-18T00:00:00+00:00" itemprop="datePublished"/><meta content="2025-10-09T15:27:51+02:00" itemprop="dateModified"/><meta content="860" itemprop="wordCount"/><meta content="" itemprop="keywords"/><meta content="summary" name="twitter:card"/><meta content="RLC-Elements" name="twitter:title"/><meta content="EMT Equations and Modified Nodal Analysis Inductance An inductance is described by
$$v_j(t) - v_k(t) = v_L(t) = L \frac{\mathrm{d} i_L(t)}{\mathrm{d}t}$$Integration results in an equation to compute the current at time $t$ from a previous state at $t - \Delta t$.
$$i_L(t) = i_L(t - \Delta t) + \frac{1}{L} \ \int_{t - \Delta t}^{t} v_L(\tau) \ \mathrm{d} \tau$$There are various methods to discretize this equation in order to solve it numerically." name="twitter:description"/><link as="style" href="../../../scss/main.min.73bc65c1e18bb0cbd02b071f40b73b018bed23b1835e915c0f4f73a772a6713b.css" rel="preload"/><link href="../../../scss/main.min.73bc65c1e18bb0cbd02b071f40b73b018bed23b1835e915c0f4f73a772a6713b.css" integrity="" rel="stylesheet"/><script crossorigin="anonymous" integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script crossorigin="anonymous" defer="" integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli" src="https://unpkg.com/lunr@2.3.9/lunr.min.js"></script></head><body class="td-page"><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class="navbar-brand" href="../../../index.html"><span class="navbar-brand__logo navbar-logo"></span><span class="navbar-brand__name">DPsim</span></a><div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar"><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href="../../index.html"><span class="active">Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><div class="td-search td-search--offline"><div class="td-search__icon"></div><input aria-label="Search this site…" autocomplete="off" class="td-search__input form-control" data-offline-search-base-href="/" data-offline-search-index-json-src="/offline-search-index.6e190e0fa554642d85037c34aa773c60.json" data-offline-search-max-results="10" placeholder="Search this site…" type="search"/></div></div></nav></header><div class="container-fluid td-outer"><div class="td-main"><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div class="td-sidebar__inner" id="td-sidebar-menu"><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class="td-search__icon"></div><input aria-label="Search this site…" autocomplete="off" class="td-search__input form-control" data-offline-search-base-href="/" data-offline-search-index-json-src="/offline-search-index.6e190e0fa554642d85037c34aa773c60.json" data-offline-search-max-results="10" placeholder="Search this site…" type="search"/></div><button aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation" class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" data-target="#td-section-nav" data-toggle="collapse" type="button"></button></form><nav class="collapse td-sidebar-nav" id="td-section-nav"><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docs-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" href="../../index.html" id="m-docs"><span>Documentation</span></a><ul class="ul-1"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsoverview-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section" href="../../overview/index.html" id="m-docsoverview"><span>Overview</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsoverviewarchitecture-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../overview/architecture/index.html" id="m-docsoverviewarchitecture"><span>Architecture</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsoverviewattributes-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../overview/attributes/index.html" id="m-docsoverviewattributes"><span>Attributes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsoverviewscheduling-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../overview/scheduling/index.html" id="m-docsoverviewscheduling"><span>Scheduling</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsoverviewinterfaces-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../overview/interfaces/index.html" id="m-docsoverviewinterfaces"><span>Interfaces</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsoverviewmnainterface-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../overview/mnainterface/index.html" id="m-docsoverviewmnainterface"><span>Interfacing with the MNA Solver</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsoverviewsubcomponents-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../overview/subcomponents/index.html" id="m-docsoverviewsubcomponents"><span>Subcomponent Handling</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsgetting-started-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section" href="../../getting-started/index.html" id="m-docsgetting-started"><span>Getting Started</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgetting-startedreal-time-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../getting-started/real-time/index.html" id="m-docsgetting-startedreal-time"><span>Real-Time</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgetting-startedbuild-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../getting-started/build/index.html" id="m-docsgetting-startedbuild"><span>Build</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgetting-startedinstall-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../getting-started/install/index.html" id="m-docsgetting-startedinstall"><span>Install</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsconcepts-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section" href="../../concepts/index.html" id="m-docsconcepts"><span>Concepts</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsconceptsdyn-phasors-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../concepts/dyn-phasors/index.html" id="m-docsconceptsdyn-phasors"><span>Dynamic Phasors</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsconceptsnodal-analysis-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../concepts/nodal-analysis/index.html" id="m-docsconceptsnodal-analysis"><span>Nodal Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsconceptspowerflow-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../concepts/powerflow/index.html" id="m-docsconceptspowerflow"><span>Powerflow</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsdevelopment-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section" href="../../development/index.html" id="m-docsdevelopment"><span>Development</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdevelopmentdebugging-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../development/debugging/index.html" id="m-docsdevelopmentdebugging"><span>Debugging</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdevelopmentguidelines-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../development/guidelines/index.html" id="m-docsdevelopmentguidelines"><span>Guidelines</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docsmodels-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section" href="../index.html" id="m-docsmodels"><span>Models</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmodelstransformer-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../transformer/index.html" id="m-docsmodelstransformer"><span>Transformer</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmodelsbranches-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../branches/index.html" id="m-docsmodelsbranches"><span>Branches</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmodelsinduction-machine-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../induction-machine/index.html" id="m-docsmodelsinduction-machine"><span>Induction Machine</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-docsmodelsrlc-elements-li"><a class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" href="index.html" id="m-docsmodelsrlc-elements"><span class="td-sidebar-nav-active-item">RLC-Elements</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmodelssynchronous-generator-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../synchronous-generator/index.html" id="m-docsmodelssynchronous-generator"><span>Synchronous Generator</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmodelspower-electronics-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../power-electronics/index.html" id="m-docsmodelspower-electronics"><span>VS-Inverter</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docstasks-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section" href="../../tasks/index.html" id="m-docstasks"><span>Core Tasks</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docstasksadd-model-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../tasks/add-model/index.html" id="m-docstasksadd-model"><span>Add New Model</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docstaskscreate-simulation-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../tasks/create-simulation/index.html" id="m-docstaskscreate-simulation"><span>Create New Simulation</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamples-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__section" href="../../examples/index.html" id="m-docsexamples"><span>Examples</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsroadmap-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../roadmap/index.html" id="m-docsroadmap"><span>Roadmap</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsreference-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../reference/index.html" id="m-docsreference"><span>Reference</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docscontribution-guidelines-li"><a class="align-left pl-0 td-sidebar-link td-sidebar-link__page" href="../../contribution-guidelines/index.html" id="m-docscontribution-guidelines"><span>Contribution Guidelines</span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a class="td-page-meta--view" href="https://github.com/sogno-platform/dpsim/tree/master/content/en/docs/Models/RLC-Elements/index.md" rel="noopener" target="_blank"><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a class="td-page-meta--edit" href="https://github.com/sogno-platform/dpsim/edit/master/content/en/docs/Models/RLC-Elements/index.md" rel="noopener" target="_blank"><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a class="td-page-meta--child" href="https://github.com/sogno-platform/dpsim/new/master/content/en/docs/Models/RLC-Elements/index.md?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" rel="noopener" target="_blank"><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a class="td-page-meta--issue" href="https://github.com/sogno-platform/dpsim/issues/new?title=RLC-Elements" rel="noopener" target="_blank"><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a class="td-page-meta--project-issue" href="https://github.com/sogno-platform/dpsim/issues/new" rel="noopener" target="_blank"><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a>
<a href="../_print/index.html" id="print"><i class="fa-solid fa-print fa-fw"></i> Print entire section</a></div><div class="td-toc"><nav id="TableOfContents"><ul><li><a href="index.html">Inductance</a></li><li><a href="index.html">Capacitance</a></li><li><a href="index.html">Extension with Dynamic Phasors</a></li><li><a href="index.html">Inductance</a></li><li><a href="index.html">Capacitance</a></li><li><a href="index.html">RL-series element</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main"><nav aria-label="breadcrumb" class="td-breadcrumbs"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../index.html">Documentation</a></li><li class="breadcrumb-item"><a href="../index.html">Models</a></li><li aria-current="page" class="breadcrumb-item active"><a aria-disabled="true" class="btn-link disabled" href="index.html">RLC-Elements</a></li></ol></nav><div class="td-content"><h1>RLC-Elements</h1><header class="article-meta"></header><h1 id="emt-equations-and-modified-nodal-analysis">EMT Equations and Modified Nodal Analysis</h1><h2 id="inductance">Inductance</h2><p>An inductance is described by</p><div class="math">$$v_j(t) - v_k(t) = v_L(t) = L \frac{\mathrm{d} i_L(t)}{\mathrm{d}t}$$</div><p>Integration results in an equation to compute the current at time $t$ from a previous state at $t - \Delta t$.</p><div class="math">$$i_L(t) = i_L(t - \Delta t) + \frac{1}{L} \ \int_{t - \Delta t}^{t} v_L(\tau) \ \mathrm{d} \tau$$</div><p>There are various methods to discretize this equation in order to solve it numerically.
The trapezoidal rule, an implicit second-order method, is commonly applied for circuit simulation:</p><div class="math">$$\int_{t - \Delta t}^{t} f(\tau) \ \mathrm{d} \tau \approx \frac{\Delta t}{2}(f(t) + f(t - \Delta t))$$</div><p>Applying the trapezoidal rule to leads to</p><div class="math">$$i_L(t) = i_L(t - \Delta t) + \frac{\Delta t}{2L}(v_L(t) + v_L(t - \Delta t))$$</div><p>This can be rewritten in terms of an equivalent conductance and current source and the number of time steps $k$ with size $\Delta t$.</p><div class="math">$$i_L(k) = g_L v_L(k) + i_{L,equiv}(k-1)$$</div><div class="math">$$i_{L,equiv}(k-1) = i_L(k-1) + \frac{\Delta t}{2L} v_L(k-1)$$</div><div class="math">$$g_L = \frac{\Delta t}{2L}$$</div><p>Hence, components described by differential equations are transformed into a DC equivalent circuit as depicted in the figure below.</p><p><img alt="inductance resistive companion" src="electrical_resistive_companion_inductance.svg"/></p><h2 id="capacitance">Capacitance</h2><p>The same procedure can be applied to a capacitance.
Integration on both side yields</p><div class="math">$$i_C(t) = C \frac{\mathrm{d}}{\mathrm{d}t} \ v_C(t)$$</div><div class="math">$$v_C(t) = v_C(t - \Delta t) + \frac{1}{C} \int_{t - \Delta t}^t i_C(\tau) \mathrm{d} \tau$$</div><p>Finally, the equivalent circuit is described by a current source and a conductance.</p><div class="math">$$i_{C}(k) = g_{C} v_C(k) + i_{C,equiv}(k-1)$$</div><div class="math">$$i_{C,equiv}(k-1) = -i_{C}(k-1) - g_C v_C(k-1)$$</div><div class="math">$$g_{C} = \frac{2C}{\Delta t}$$</div><p>This equation set is visualized in the figure below.</p><p><img alt="capacitance resistive companion" src="electrical_resistive_companion_capacitance.svg"/></p><p>Hence, the vector of unknowns $\bm{x}$ and the source vector $\bm{b}$ become time dependent and this leads to the system description:</p><div class="math">$$\bm{A} \bm{x}(t) = \bm{b}(t)$$</div><p>To simulate the transient behavior of circuits, this linear equation has to be solved repeatedly.
As long as the system topology and the time step is fixed, the system matrix is constant.</p><h2 id="extension-with-dynamic-phasors">Extension with Dynamic Phasors</h2><p>The dynamic phasor concept can be integrated with nodal analysis.
The overall procedure does not change but the system equations are rewritten using complex numbers and all variables need to be expressed in terms of dynamic phasors.
Therefore, the resistive companion representations of inductances and capacitances have to be adapted as well.</p><h2 id="inductance-1">Inductance</h2><p>In dynamic phasors the integration of the inductance equation yields</p><div class="math">$$\begin{align}
\langle v_L \rangle(t) &amp;= \Big \langle L \frac{\mathrm{d} i_L}{\mathrm{d}t} \Big \rangle(t) \nonumber \\
&amp;= L \frac{\mathrm{d}}{dt} \langle i_L \rangle(t) + j \omega L \ \langle i_L \rangle(t)
\end{align}$$</div><div class="math">$$\langle i_L \rangle(t) = \langle i_L \rangle(t - \Delta t) + \int_{t - \Delta t}^t \frac{1}{L} \langle v_L \rangle(\tau) - j \omega \ \langle i_L \rangle(\tau) \mathrm{d} \tau$$</div><p>Applying the trapezoidal method leads to the finite difference equation:</p><div class="math">$$\begin{split}
\langle i_L \rangle(k) = \langle i_L \rangle(k-1) + \frac{\Delta t}{2} \bigg[ \frac{1}{L} (\langle v_L \rangle(k) + \langle v_L \rangle(k-1))
- j \omega (\langle i_L \rangle(t) + \langle i_L \rangle(k-1) \bigg]
\end{split}$$</div><p>Solving this for $\langle i_L \rangle(k)$ results in the \ac{DP} equivalent circuit model:</p><div class="math">$$\langle i_L \rangle(k) = \frac{a - jab}{1 + b^2} \langle v_L \rangle(k) + \langle i_{L,equiv} \rangle(k-1)$$</div><p>with</p><div class="math">$$a = \frac{\Delta t}{2L}, \qquad b = \frac{\Delta t \omega}{2}$$</div><div class="math">$$\langle i_{L,equiv} \rangle(k-1) = \frac{1 - b^2 - j2b}{1 + b^2} \langle i_L \rangle(k-1) + \frac{a - jab}{1 + b^2} \langle v_L \rangle(k-1)$$</div><h2 id="capacitance-1">Capacitance</h2><p>Similarly, a capacitance is described by as follows</p><div class="math">$$\langle i_C \rangle(k) = C \ \frac{\mathrm{d} \langle v_C \rangle}{\mathrm{d} t} + j \omega C \ \langle v_C \rangle(t)$$</div><div class="math">$$v_C(t) = v_C(t- \Delta t) + \int_{t- \Delta t}^{t} \frac{1}{C} \ i_C(\tau) -j \omega \ v_C(\tau) \ \mathrm{d} \tau$$</div><p>Applying the trapezoidal rule for the capacitance equation leads to the finite difference equation:</p><div class="math">$$\begin{split}
\langle v_C \rangle(k) = \langle v_C \rangle(k-1)
+ \frac{\Delta t}{2} \bigg[ \frac{1}{C} \ \langle i_C \rangle(k) - j \omega \ \langle v_C \rangle(k) \\
+ \frac{1}{C} \ \langle i_C \rangle(k-1) - j \omega \ \langle v_C \rangle(k-1) \bigg]
\end{split}$$</div><p>The DP model for the capacitance is defined by</p><div class="math">$$\langle i_C \rangle(k) = \frac{1+jb}{a} \ \langle v_C \rangle(k) + \langle i_{C,equiv} \rangle(k-1)$$</div><p>with</p><div class="math">$$a = \frac{\Delta t}{2C}, \qquad
b = \frac{\Delta t \omega}{2}$$</div><div class="math">$$\langle i_{C,equiv} \rangle(k-1) = - \frac{1-jb}{a} \ \langle v_C \rangle(k-1) - \langle i_C \rangle(k-1)$$</div><h2 id="rl-series-element">RL-series element</h2><p>In dynamic phasors the integration of the inductance equation yields</p><div class="math">$$\langle v \rangle(t) = L \frac{\mathrm{d}}{dt} \langle i \rangle(t) + j \omega L \ \langle i \rangle(t) + R \ \langle i \rangle(t)$$</div><div class="math">$$\langle i \rangle(t) = \langle i \rangle(t - \Delta t) + \int_{t - \Delta t}^t \frac{1}{L} \langle v \rangle(\tau) - j \omega \ \langle i \rangle(\tau) - \frac{R}{L} \ \langle i \rangle(\tau) \mathrm{d} \tau$$</div><p>Applying the trapezoidal method leads to the finite difference equation:</p><div class="math">$$\begin{split}
\langle i \rangle(k) = \langle i \rangle(k-1) + \frac{\Delta t}{2} \bigg[ \frac{1}{L} (\langle v \rangle(k) + \langle v \rangle(k-1))
- \left( j \omega + \frac{R}{L} \right) (\langle i \rangle(k) + \langle i \rangle(k-1)) \bigg]
\end{split}$$</div><p>Solving this for $\langle i \rangle(k)$ results in the \ac{DP} equivalent circuit model:</p><div class="math">$$\langle i \rangle(k) = \frac{a + Ra^2 - jab}{(1+Ra)^2 + b^2} \langle v \rangle(k) + \langle i_{equiv} \rangle(k-1)$$</div><p>with</p><div class="math">$$a = \frac{\Delta t}{2L}, \qquad b = \frac{\Delta t \omega}{2}$$</div><div class="math">$$\langle i_{equiv} \rangle(k-1) = \frac{1 - b^2 - j2b + 2Ra + (Ra)^2 - j2Rab}{(1+Ra^2) + b^2} \langle i \rangle(k-1) + \frac{a + Ra^2 - jab}{(1+Ra)^2 + b^2} \langle v \rangle(k-1)$$</div><div class="text-muted mt-5 pt-3 border-top">Last modified 09.10.2025: <a href="https://github.com/sogno-platform/dpsim/commit/452323ca7ab3dc1e75644a56f682e6fe0c3e4ac4">chore(deps): Bump pypa/gh-action-pypi-publish from 1.12.4 to 1.13.0 in /.github/workflows (#405) (452323c)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class="row"><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li aria-label="Slack" class="list-inline-item mx-2 h3" data-placement="top" data-toggle="tooltip" title="Slack"><a aria-label="Slack" class="text-white" href="https://slack.lfenergy.org/" rel="noopener" target="_blank"><i class="fab fa-slack"></i></a></li><li aria-label="GitHub Discussions" class="list-inline-item mx-2 h3" data-placement="top" data-toggle="tooltip" title="GitHub Discussions"><a aria-label="GitHub Discussions" class="text-white" href="https://github.com/sogno-platform/dpsim/discussions" rel="noopener" target="_blank"><i class="fab fa-github"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li aria-label="GitHub" class="list-inline-item mx-2 h3" data-placement="top" data-toggle="tooltip" title="GitHub"><a aria-label="GitHub" class="text-white" href="https://github.com/sogno-platform/dpsim" rel="noopener" target="_blank"><i class="fab fa-github"></i></a></li><li aria-label="RWTH GitLab" class="list-inline-item mx-2 h3" data-placement="top" data-toggle="tooltip" title="RWTH GitLab"><a aria-label="RWTH GitLab" class="text-white" href="https://git.rwth-aachen.de/acs/public/simulation/dpsim/dpsim" rel="noopener" target="_blank"><i class="fab fa-gitlab"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class="text-white">© 2025 The DPsim Authors All Rights Reserved</small></div></div></div></footer></div><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" integrity="sha512-6VMVcy7XQNyarhVuiL50FzpgCFKsyTd6YO93aaQEyET+BNaWvj0IgKR86Bf6+AmWczxAcSnL+JGjo+iStgO1gQ==" rel="stylesheet"/><script crossorigin="anonymous" defer="" integrity="sha512-b9IKj4LCNrtCPBhceRcoYOHWW/S2q9fpl7iAJlyxYpykRj1SKM7FE9+E0NEnJ8g8ni47LBr2GuX9qzg/xeuwzQ==" src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.js"></script><script crossorigin="anonymous" defer="" integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg==" onload='renderMathInElement(document.body,{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"},{display:!0,left:"\\[",right:"\\]"}]})' src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js"></script><script crossorigin="anonymous" integrity="sha256-Kv+YPp0Njs/57VPhS2VyFuLY0q/wWb9KVlEoMCCZXxs=" src="../../../js/main.min.2aff983e9d0d8ecff9ed53e14b657216e2d8d2aff059bf4a5651283020995f1b.js"></script>
<script src="../../../js/tabpane-persist.js"></script></body></html>